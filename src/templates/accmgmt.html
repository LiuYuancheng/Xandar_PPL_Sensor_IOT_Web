<!-- user page templage base.html -->
{% extends 'mgmbase.html'%}

{% block mgmContent %}

<ul class="list-group">
    <li class="list-group-item">
        <h4> Users Account Management </h4>
        <table class="table table-dark">
            <table class="table table-dark">
                <thead>
                    <tr class="table table-info">
                        <!-- <th>Index</th> -->
                        <th>User ID </th>
                        <th>User Type</th>
                        <th>User Password </th>
                        <th>Password reset</th>
                        <th>Delete User </th>
                    </tr>
                </thead>
                <tbody>
                    {% for post in posts %}
                    <tr>
                        <td> {{ post['id'] }} </td>
                        <td> {{ post['type'] }} </td>
                        <td> {{ post['password'] }} </td>
                        <td>
                            <form action="#" method="POST">
                                <input type="submit" value="Reset Password" class="btn btn-warning btn-sm"
                                    onclick=" return confirm('Are you sure you want to change the account password?')">
                            </form>
                        </td>
                        <td>
                            {% if post['id'] == 'admin' %}
                                - 
                            {% else %}
                                <form action="#" method="POST">
                                    <input type="submit" value="Enable" class="btn btn-success btn-sm"
                                        onclick=" return confirm('Active the account ?')">
                                </form>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
        </table>
    </li>
</ul>

    {% with message=get_flashed_messages() %}
        {% if message[0] %}
            <form class="form-inline">
                Account: &emsp; {{ message[0] }} 
                
                {% if message[1] == 'reset' %}
                    's new password is set to : &emsp;
                    <kbd id="copyme"> {{ message[2] }} </kbd> &emsp;
                    <button type="button" class="btn btn-primary btn-xs" onclick="clip_div('copyme')">copy to clipboard</button>
                {% elif message[1] == 'delete' %}
                    account delete result {{message[2]}}                
                {% endif %}

            </form>
            <script>
                function clip_text(a_string){
                    var input = document.createElement('input')
                    input.id="__copyText__";
                    input.value = a_string; // OOPS! document.getElementById(divId).innerText;
                    document.body.appendChild(input);
                    input.select();
                    document.execCommand("copy");
                    var txt = input.value
                    input.remove()
                    console.log("OK COPIED: '"+txt+"'")
                }
                function clip_div(divId){
                   return clip_text(document.getElementById(divId).innerText)
                }
            </script>
        {% endif%}
    {% endwith%}

{% endblock %}
